From 6230a6fae0c84696e2e52e7a1d720edfd54dd38d Mon Sep 17 00:00:00 2001
From: Germán Poo-Caamaño <gpoo@gnome.org>
Date: Fri, 31 May 2013 01:05:36 +0000
Subject: libview: Check number of pages on ev_view_document_changed_cb

Fix crash on corrupted PDF with no pages.

Thanks to Juha Kylmänen from OUSPG who were testing robutness.
(CVE-2013-3718).

https://bugzilla.gnome.org/show_bug.cgi?id=701302
---
Index: evince-3.8.2/libview/ev-view.c
===================================================================
--- evince-3.8.2.orig/libview/ev-view.c	2013-06-06 13:36:30.365420171 -0400
+++ evince-3.8.2/libview/ev-view.c	2013-06-06 13:36:30.365420171 -0400
@@ -5508,6 +5508,10 @@
 {
 	EvDocument *document = ev_document_model_get_document (model);
 
+	if (ev_document_get_n_pages (document) <= 0 ||
+	    !ev_document_check_dimensions (document))
+		return;
+
 	if (document != view->document) {
 		gint current_page;
 
